1.从rabbitmq消费消息,消息大概包含以下字段[酒店ID,房间号,实际抵店时间,预离时间],
2.以酒店ID,房间号为条件,去mysql查询smart_meter表中的script_time字段与实际抵店时间最近的数据,并记录smart_meter表中的累计用电量数值
3.每与上面的实际抵店时间间隔30分钟,查询smart_meter表中统一酒店ID,房间号的累计用电量,并与上一次30分钟记录的累计用电量计算差值,
  如果这个差值连续4次大约2,则记录为此酒店ID,此房间号用电异常,并计算连续4次的用电量,将此结果写入到一个mysql表中,然后向飞书群组机器人发送提醒信息
请帮我看看下上面的需求可否是用flink进行实现,或者简单使用pyhton写脚本实现,或者有没有其他的比较的好的方式来实现.
然后具体设计下业务流程及代码实现逻辑


在保证现有功能不变的情况下,增加新的需求,mq中除了以上的的[酒店ID,房间号,实际抵店时间,预离时间]这种的入住消息之外,还会有同一酒店ID,同一房间号的离店消息,格式如下[酒店ID,房间号,实际抵店时间,实际离店时间].
在消费到此离店消息时,同样进行每隔30分钟查询smart_meter表中统一酒店ID,房间号的累计用电量,并与上一次30分钟记录的累计用电量计算差值,如果这个差值连续4次大约1.5,则记录为此酒店ID,
此房间号用电异常,并计算连续4次的用电量,将此结果写入到一个mysql表中,然后向飞书群组机器人发送提醒信息

mq中入住消息中会有个msgType字段,当msgType=5710005时,为入住消息,当msgType=5710013时,为离店消息
